{"version":3,"file":"build.js","sources":["../src/utils/world.js","../src/utils/display.js","../src/utils/game.js","../src/index.js"],"sourcesContent":["export default { generate, indexToPos, posToIndex, getNeighbors, getAt, setAt, contains }\n\nconst UP_LEFT    = [-1, -1]\nconst UP         = [ 0, -1]\nconst UP_RIGHT   = [ 1, -1]\nconst LEFT       = [-1,  0]\nconst RIGHT      = [ 1,  0]\nconst DOWN_LEFT  = [-1,  1]\nconst DOWN       = [ 0,  1]\nconst DOWN_RIGHT = [ 1,  1]\nconst directions = [UP_LEFT, UP, UP_RIGHT, LEFT, RIGHT, DOWN_LEFT, DOWN, DOWN_RIGHT]\n\nfunction generate(size) {\n\n  var area = size * size\n  var data = new Uint8ClampedArray(area)\n  var i = area\n  while (i--)\n    data[i] = Math.random() > 0.75\n\n  return data\n\n}\n\nfunction indexToPos(index, size) {\n  var x = index % size\n  var y = (index - x) / size\n  return [x, y]\n}\n\nfunction posToIndex(pos, size) {\n  var [x, y] = pos\n  return y * size + x\n}\n\nfunction getNeighbors(pos, size) {\n  if (!size)\n    return []\n  var neighbors = []\n  var [x, y] = pos\n  for (var direction of directions) {\n    var [dx, dy] = direction\n    var cx = x + dx\n    var cy = y + dy\n    if (cx < 0)\n      cx += size\n    if (cx >= size)\n      cx -= size\n    if (cy < 0)\n      cy += size\n    if (cy >= size)\n      cy -= size\n    var current = [cx, cy]\n    neighbors.push(current)\n  }\n  return neighbors\n}\n\nfunction getAt(data, pos, size) {\n  if (!size)\n    size = Math.sqrt(data.length)\n  if ( !contains(pos, size) )\n    return null\n  var index = posToIndex(pos, size)\n  return data[index]\n}\n\nfunction setAt(data, pos, id, size) {\n  if (!size)\n    size = Math.sqrt(data.length)\n  if ( !contains(pos, size) )\n    return null\n  var index = posToIndex(pos, size)\n  data[index] = id\n  return id\n}\n\nfunction contains(pos, size) {\n  var [x, y] = pos\n  return x >= 0 && y >= 0 && x < size && y < size\n}\n","function create(width, height) {\n\n  var _width  = width\n  var _height = height\n  if (!height)\n    if ( Array.isArray(width) )\n      [_width, _height] = width\n    else if ( !isNaN(width) )\n      _height = width\n\n  var _aspect = _width / _height\n  var _canvas = document.createElement('canvas')\n  var _canvasWidth  = _canvas.width  = _width\n  var _canvasHeight = _canvas.height = _height\n  var _context = _canvas.getContext('2d')\n  var _parent  = null\n  var _buffer  = null\n\n  function mount(parent) {\n    if (typeof parent === 'string')\n      parent = document.querySelector(parent)\n    if (!parent)\n      throw new TypeError(`Cannot mount display onto parent element '${parent}'`)\n    parent.appendChild(_canvas)\n    _parent = parent\n    render()\n    return display\n  }\n\n  function clear() {\n    _context.fillStyle = 'black'\n    _context.fillRect(0, 0, _canvasWidth, _canvasHeight)\n  }\n\n  function render(buffer) {\n    if (!_buffer)\n      clear()\n    buffer = buffer || _buffer\n    if (!buffer)\n      return display\n\n    // var i = buffer.length\n    // while (i--) {\n    //   var x = i % _width\n    //   var y = (i - x) / _width\n    //   var id = buffer[i]\n    //   if ( !_buffer || id !== _buffer[i] ) {\n    //     _context.fillStyle = id ? 'white' : 'black'\n    //     _context.fillRect(x, y, 1, 1)\n    //   }\n    // }\n\n    var imageData = _context.createImageData(_width, _height)\n    var data = imageData.data\n    var index = buffer.length\n    while (index--) {\n      var i = index * 4\n      var x = index % _width\n      var y = (index - x) / _width\n      var status = buffer[index]\n      var cached = null\n      if (_buffer)\n        cached = _buffer[index]\n      var value = status ? 255 : 0\n      // if (cached && status !== cached || !cached) {\n        data[i]     = value\n        data[i + 1] = value\n        data[i + 2] = value\n        data[i + 3] = 255\n      // }\n    }\n\n    _context.putImageData(imageData, 0, 0)\n\n    _buffer = buffer\n    return display\n  }\n\n  var display = { width: _width, height: _height, aspect: _aspect, context: _context, mount, clear, render }\n  return display\n\n}\n\nexport default { create }\n","import { World, Display } from './index'\n\nexport default { create }\n\nfunction create(size, element) {\n\n  const DEAD = 0\n  const LIVE = 1\n\n  var world   = World.generate(size)\n  var display = Display.create(size).mount('#app').render(world)\n\n  function update(world, size) {\n    var result = []\n    var i = world.length\n    while (i--) {\n      var id = world[i]\n      var pos = World.indexToPos(i, size)\n      var neighbors = World.getNeighbors(pos, size)\n      var live = 0\n      for (var neighbor of neighbors)\n        if (World.getAt(world, neighbor, size) === LIVE)\n          live++\n      // Could abbreviate this using ternaries or raw booleans over here but it's better to keep it legible\n      if (id === LIVE)\n        if (live === 2 || live === 3)\n          id = LIVE\n        else\n          id = DEAD\n      else if (id === DEAD)\n        if (live === 3)\n          id = LIVE\n        else\n          id = DEAD\n        result[i] = id\n    }\n    return result\n  }\n\n  function tick() {\n    world = update(world, size)\n    display.render(world)\n  }\n\n  return { update, tick }\n\n}\n","import { Game } from './utils/index'\n\nvar game = Game.create(128, '#app')\n\nfunction animate() {\n  game.tick()\n  window.requestAnimationFrame(animate)\n}\nanimate()\n"],"names":["generate","indexToPos","posToIndex","getNeighbors","getAt","setAt","contains","UP_LEFT","UP","UP_RIGHT","LEFT","RIGHT","DOWN_LEFT","DOWN","DOWN_RIGHT","directions","size","area","data","Uint8ClampedArray","i","Math","random","index","x","y","pos","neighbors","direction","dx","dy","cx","cy","current","push","sqrt","length","id","create","width","height","_width","_height","Array","isArray","isNaN","_aspect","_canvas","document","createElement","_canvasWidth","_canvasHeight","_context","getContext","_parent","_buffer","mount","parent","querySelector","TypeError","appendChild","display","clear","fillStyle","fillRect","render","buffer","imageData","createImageData","status","cached","value","putImageData","aspect","context","element","DEAD","LIVE","world","World","Display","update","result","live","neighbor","tick","game","Game","animate","requestAnimationFrame"],"mappings":"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"}